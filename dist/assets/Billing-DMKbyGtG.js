import{j as e,m as o}from"./motion-DEFBAXox.js";import{a as i}from"./vendor-C4jSHSwK.js";import{u as c,s as y,i as u,j as b}from"./index-DicW4zRf.js";import{P as f,S as j,a as g}from"./StripeWebhookInfo-DAyxlWho.js";import{F as v}from"./DocumentArrowDownIcon-CFaK7p-O.js";import"./i18n-DQkvtCzx.js";import"./ui-Nk6LSbPB.js";import"./stripe-service-jIMPwR8k.js";import"./index-D-twCb4o.js";import"./PlusIcon-ySxxH9nU.js";import"./TrashIcon-CkYu8bNi.js";import"./ClipboardIcon-Ddvdg0PT.js";function N(){const{user:a}=c(),[r,s]=i.useState([]),[m,d]=i.useState(!0),[l,x]=i.useState(null);i.useEffect(()=>{a&&p()},[a]);const p=async()=>{try{d(!0),x(null);const{data:t,error:n}=await y.functions.invoke("list-invoices",{body:{userId:a?.id}});if(n)throw n;s(t||[])}catch(t){console.error("Error loading invoices:",t),x(t.message||"Une erreur est survenue")}finally{d(!1)}},h=(t,n)=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:n.toUpperCase()}).format(t/100);return m?e.jsx("div",{className:"flex justify-center py-6",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-400"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Historique des factures"}),l&&e.jsx("div",{className:"bg-red-900/50 text-red-400 p-4 rounded-lg",children:l}),r.length===0?e.jsx("div",{className:"bg-white/5 rounded-lg p-6 text-center",children:e.jsx("p",{className:"text-gray-400",children:"Aucune facture disponible"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-white/10",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Numéro"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Montant"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Statut"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-white/10",children:r.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:t.number}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:u(new Date(t.created*1e3),"dd MMMM yyyy",{locale:b})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:h(t.amount_paid,t.currency)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.status==="paid"?"bg-green-900/50 text-green-400":t.status==="open"?"bg-yellow-900/50 text-yellow-400":"bg-red-900/50 text-red-400"}`,children:t.status==="paid"?"Payée":t.status==="open"?"En attente":"Non payée"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("a",{href:t.hosted_invoice_url,target:"_blank",rel:"noopener noreferrer",className:"text-primary-400 hover:text-primary-300",children:"Voir"}),e.jsxs("a",{href:t.pdf,target:"_blank",rel:"noopener noreferrer",className:"text-primary-400 hover:text-primary-300 flex items-center gap-1",children:[e.jsx(v,{className:"h-4 w-4"}),"PDF"]})]})})]},t.id))})]})})]})}function w(){const{user:a}=c(),[r,s]=i.useState("invoices");return a?e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-lg font-medium text-white",children:"Historique de facturation"}),e.jsx("div",{className:"mb-6 border-b border-white/10",children:e.jsxs("nav",{className:"flex space-x-8",children:[e.jsx("button",{onClick:()=>s("invoices"),className:`py-4 px-1 border-b-2 font-medium text-sm ${r==="invoices"?"border-primary-400 text-primary-400":"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-300"}`,children:"Factures"}),e.jsx("button",{onClick:()=>s("payment-methods"),className:`py-4 px-1 border-b-2 font-medium text-sm ${r==="payment-methods"?"border-primary-400 text-primary-400":"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-300"}`,children:"Méthodes de paiement"})]})}),r==="invoices"&&e.jsx("div",{children:e.jsx(N,{})}),r==="payment-methods"&&e.jsx("div",{children:e.jsx(f,{})})]}):null}function P(){const{user:a}=c(),[r,s]=i.useState("subscription");return a?e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Facturation"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Gérez votre abonnement et consultez votre historique de facturation"})]}),e.jsx("div",{className:"mb-6 border-b border-white/10",children:e.jsxs("nav",{className:"flex space-x-8",children:[e.jsx("button",{onClick:()=>s("subscription"),className:`py-4 px-1 border-b-2 font-medium text-sm ${r==="subscription"?"border-primary-400 text-primary-400":"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-300"}`,children:"Abonnement"}),e.jsx("button",{onClick:()=>s("history"),className:`py-4 px-1 border-b-2 font-medium text-sm ${r==="history"?"border-primary-400 text-primary-400":"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-300"}`,children:"Historique"}),e.jsx("button",{onClick:()=>s("webhook"),className:`py-4 px-1 border-b-2 font-medium text-sm ${r==="webhook"?"border-primary-400 text-primary-400":"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-300"}`,children:"Webhook"})]})}),e.jsxs("div",{className:"card",children:[r==="subscription"&&e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:e.jsx(j,{})}),r==="history"&&e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:e.jsx(w,{})}),r==="webhook"&&e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:e.jsx(g,{})})]})]}):null}export{P as default};
//# sourceMappingURL=Billing-DMKbyGtG.js.map
